                ;***********************************************************
                ;
                ;       SUBROUTINE EXPLOD
                ;       VERSION         3B
                ;
                ;       DRAWS EXPLOSIONS OF 32 LINES
                ;       EXPRPE=NUMBER OF EXPLOSIONS
                ;       EXPX=X POSITION OF THE EXPLOSION
                ;       EXPY=Y POSITION OF THE EXPLOSION
                ;       ALL REGISTERS ARE RESTORED
         000000         R0=%0
         000001         R1=%1
         000002         R2=%2
         000003         R3=%3
         000004         R4=%4
         000005         R5=%5
         000006         R6=%6
         000007         R7=%7
         000006         SP=R6
         000007         PC=R7
                        .TITLE  EXPLOD
                        .GLOBL  SLINE,EXPLOD,EXPREP,EXPX,EXPY
         000000         .CSECT
  000000 010046 EXPLOD: MOV     R0,-(SP)
  000002 010146         MOV     R1,-(SP)
  000004 010246         MOV     R2,-(SP)
  000006 010346         MOV     R3,-(SP)
  000010 010446         MOV     R4,-(SP)
  000012 010546         MOV     R5,-(SP)
  000014 012767 EXP01:  MOV     #32.,EXPCTR     ;PUSH LINE COUNT IN CTR
         000040
         000076
  000022 012767'        MOV     #EXPBGN,EXPPTR  ;SET PTR
         000130
         000072
  000030 016700 EXP02:  MOV     EXPPTR,R0       ;SET UP PTR
         000066
  000034 012004         MOV     (R0)+,R4        ;R4=XEXP
  000036 012005         MOV     (R0)+,R5        ;R5=YEXP
  000040 010067         MOV     R0,EXPPTR       ;SAVE NEW PTR
         000056
  000044 016702         MOV     EXPX,R2         ;R2=XDISP
         000054
  000050 016703         MOV     EXPY,R3         ;R3=YDISP
         000052
  000054 060204         ADD     R2,R4           ;R4=XDISP+XEXP
  000056 060305         ADD     R3,R5           ;R5=YDISP+YEXP
  000060 004767'        JSR     PC,SLINE        ;DRAW A LINE
         000000
  000064 005367         DEC     EXPCTR          ;ARE THERE MORE LINES?
         000030
  000070 003357         BGT     EXP02           ;YES-DO IT AGAIN 
  000072 005367         DEC     EXPREP          ;NO-ARE THERE MORE REPEATS?
         000020
  000076 003346         BGT     EXP01           ;YES-DO IT ALL AGAIN
  000100 012605         MOV     (SP)+,R5

                        PAGE    001

  000102 012604         MOV     (SP)+,R4
  000104 012603         MOV     (SP)+,R3
  000106 012602         MOV     (SP)+,R2
  000110 012601         MOV     (SP)+,R1
  000112 012600         MOV     (SP)+,R0
  000114 000207         RTS     PC              ;SUBROUTINE DONE
  000116 000000 EXPREP: .WORD   0
  000120 000000 EXPCTR: .WORD   0
  000122 000000 EXPPTR: .WORD   0
  000124 000000 EXPX:   .WORD   0
  000126 000000 EXPY:   .WORD   0
                ;FIRST GROUP OF LINES
  000130 003731 EXPBGN: .WORD   2009.,400.,1703.,1138.
  000132 000620
  000134 003247
  000136 002162
  000140 002162         .WORD   1138.,1703.,400.,2009.
  000142 003247
  000144 000620
  000146 003731
  000150 177160         .WORD   -400.,2009.,-1138.,1703.
  000152 003731
  000154 175616
  000156 003247
  000160 174531         .WORD   -1703.,1138.,-2009.,400.
  000162 002162
  000164 174047
  000166 000620
  000170 174047         .WORD   -2009.,-400.,-1703.,-1138.
  000172 177160
  000174 174531
  000176 175616
  000200 175616         .WORD   -1138.,-1703.,-400.,-2009.
  000202 174531
  000204 177160
  000206 174047
  000210 000620         .WORD   400.,-2009.,1138.,-1703.
  000212 174047
  000214 002162
  000216 174531
  000220 003247         .WORD   1703.,-1138.,2009.,-400.
  000222 175616
  000224 003731
  000226 177160
                ;SECOND GROUP OF LINES
  000230 010000         .WORD   4096.,0.,3784.,1567.
  000232 000000
  000234 007310
  000236 003037
  000240 005520         .WORD   2896.,2896.,1567.,3784.
  000242 005520
  000244 003037
  000246 007310
  000250 000000         .WORD   0.,4096.,-1567.,3784.
  000252 010000
  000254 174741

                        PAGE    002

  000256 007310
  000260 172260         .WORD   -2896.,2896.,-3784.,1567.
  000262 005520
  000264 170470
  000266 003037
  000270 170000         .WORD   -4096.,0.,-3784.,-1567.
  000272 000000
  000274 170470
  000276 174741
  000300 172260         .WORD   -2896.,-2896.,-1567.,-3784.
  000302 172260
  000304 174741
  000306 170470
  000310 000000         .WORD   0.,-4096.,1567.,-3784.
  000312 170000
  000314 003037
  000316 170470
  000320 005520         .WORD   2896.,-2896.,3784.,-1567.
  000322 172260
  000324 007310
  000326 174741
         000001         .END

                        PAGE    003

